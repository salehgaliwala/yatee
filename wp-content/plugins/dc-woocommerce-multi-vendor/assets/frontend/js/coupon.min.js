"use strict";var couponController=function(a){var e={addEventHandlers:function(){return a("#wcmp-afm-add-coupon").on("click","#wcmp_afm_coupon_submit, #wcmp_afm_coupon_draft",this.saveCoupon),!1},setupEnvironment:function(){return a(".date-picker").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0}),a("#usage_restriction_coupon_data #products, #usage_restriction_coupon_data #exclude_products").select2(),a("#usage_restriction_coupon_data #product_categories, #usage_restriction_coupon_data #exclude_product_categories").select2(),t.wcEnhancedSelectInit(),t.wcEnhancedSelectClose(),!1},saveCoupon:function(){a("form#wcmp-afm-add-coupon").trigger("before_coupon_save");var e="wcmp_afm_coupon_submit"===this.id?"publish":"wcmp_afm_coupon_draft"===this.id?"draft":"";return a('input:hidden[name="status"]').val(e),a("textarea#coupon_description").val(t.getTinymceContent("coupon_description")),!0}},t={init:function(){return e.setupEnvironment(),e.addEventHandlers(),!1},wcEnhancedSelectInit:function(){try{a(":input.wc-enhanced-select, :input.chosen_select").filter(":not(.enhanced)").each(function(){var e={minimumResultsForSearch:10,allowClear:!!a(this).data("allow_clear"),placeholder:a(this).data("placeholder")};a(this).selectWoo(e).addClass("enhanced")}),a(":input.wc-product-search").filter(":not(.enhanced)").each(function(){var e={allowClear:!!a(this).data("allow_clear"),placeholder:a(this).data("placeholder"),minimumInputLength:a(this).data("minimum_input_length")?a(this).data("minimum_input_length"):"3",escapeMarkup:function(e){return e},ajax:{url:add_coupon_params.ajax_url,dataType:"json",delay:250,data:function(e){return{term:e.term,action:a(this).data("action")||"woocommerce_json_search_products_and_variations",security:add_coupon_params.search_products_nonce,exclude:a(this).data("exclude"),include:a(this).data("include"),limit:a(this).data("limit")}},processResults:function(e){var n=[];return e&&a.each(e,function(e,t){n.push({id:e,text:t})}),{results:n}},cache:!0}};if(a(this).selectWoo(e).addClass("enhanced"),a(this).data("sortable")){var n=a(this),t=a(this).next(".select2-container").find("ul.select2-selection__rendered");t.sortable({placeholder:"ui-state-highlight select2-selection__choice",forcePlaceholderSize:!0,items:"li:not(.select2-search__field)",tolerance:"pointer",stop:function(){a(t.find(".select2-selection__choice").get().reverse()).each(function(){var e=a(this).data("data").id,t=n.find('option[value="'+e+'"]')[0];n.prepend(t)})}})}else a(this).prop("multiple")&&a(this).on("change",function(){var e=a(this).children();e.sort(function(e,t){var n=e.text.toLowerCase(),a=t.text.toLowerCase();return a<n?1:n<a?-1:0}),a(this).html(e)})})}catch(e){window.console.log(e)}},wcEnhancedSelectClose:function(){try{a("html").on("click",function(e){this===e.target&&a(".wc-enhanced-select, :input.wc-product-search").filter(".select2-hidden-accessible").selectWoo("close")})}catch(e){window.console.log(e)}},getTinymceContent:function(e){return a("#wp-"+e+"-wrap").hasClass("tmce-active")&&"undefined"!=typeof tinyMCE&&tinyMCE.get(e)?tinyMCE.get(e).getContent():a("textarea#"+e).val()}};return t}(jQuery);couponController.init();