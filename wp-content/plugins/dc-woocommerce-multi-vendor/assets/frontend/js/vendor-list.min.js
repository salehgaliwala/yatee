!function($){if("undefined"==typeof wcmp_vendor_list_script_data)return!1;if(wcmp_vendor_list_script_data.mapbox_emable){mapboxgl.accessToken=wcmp_vendor_list_script_data.mapbox_emable;var d=wcmp_vendor_list_script_data.stores,a=new mapboxgl.Map({container:"wcmp-vendor-list-map",style:"mapbox://styles/mapbox/satellite-v9",center:[0,0],zoom:1});d.forEach(function(c){var b=document.createElement("div");b.className="marker",b.style.backgroundImage="url("+wcmp_vendor_list_script_data.map_data.marker_icon+")",b.style.width="38px",b.style.height="50px",b.style.cursor="pointer";var d=[c.location.lat,c.location.lng];new mapboxgl.Marker(b).setLngLat(d).setPopup(new mapboxgl.Popup({offset:25}).setHTML(c.info_html)).addTo(a)});var e=(new MapboxGeocoder({accessToken:mapboxgl.accessToken,marker:{color:"red"},mapboxgl:mapboxgl}),new MapboxGeocoder({accessToken:mapboxgl.accessToken,mapboxgl:mapboxgl}));document.getElementById("locationText").appendChild(e.onAdd(a)),a.on("load",function(){e.on("result",function(a){$("#wcmp_vlist_center_lat").val(a.result.center[0]),$("#wcmp_vlist_center_lng").val(a.result.center[1])})}),a.addControl(new mapboxgl.FullscreenControl),a.addControl(new mapboxgl.NavigationControl),a.addControl(new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}));var c=document.getElementById("menu").getElementsByTagName("input");function f(b){var c=b.target.id;a.setStyle("mapbox://styles/mapbox/"+c)}for(var b=0;b<c.length;b++)c[b].onclick=f}else{var g,a,h,i=[];google.maps.event.addDomListener(window,"load",function(){var b=wcmp_vendor_list_script_data.map_data.map_options;if("1"==wcmp_vendor_list_script_data.map_data.map_style){wcmp_vendor_list_script_data.map_data.map_options.mapTypeControlOptions.mapTypeIds.push("wcmp_map_style");var c=wcmp_vendor_list_script_data.map_data.map_style_data,d=new google.maps.StyledMapType(c,{name:wcmp_vendor_list_script_data.map_data.map_style_title})}var a=new google.maps.Map(document.getElementById("wcmp-vendor-list-map"),b);function e(d,c,e,b){if(-1==b)alert(wcmp_vendor_list_script_data.lang.geolocation_doesnt_support);else switch(b.code){case b.PERMISSION_DENIED:alert(wcmp_vendor_list_script_data.lang.geolocation_permission_denied);break;case b.POSITION_UNAVAILABLE:alert(wcmp_vendor_list_script_data.lang.geolocation_position_unavailable);break;case b.TIMEOUT:alert(wcmp_vendor_list_script_data.lang.geolocation_timeout);break;case b.UNKNOWN_ERROR:alert(wcmp_vendor_list_script_data.lang.geolocation_service_failed)}c.setPosition(e),c.setContent(d?wcmp_vendor_list_script_data.lang.geolocation_service_failed:wcmp_vendor_list_script_data.lang.geolocation_doesnt_support),c.open(a)}if("1"==wcmp_vendor_list_script_data.map_data.map_style&&(a.mapTypes.set("wcmp_map_style",d),a.setMapTypeId("wcmp_map_style")),g=new google.maps.InfoWindow,h=new google.maps.LatLngBounds,navigator.geolocation?navigator.geolocation.getCurrentPosition(function(b){var c={lat:b.coords.latitude,lng:b.coords.longitude};$("#wcmp_vlist_center_lat").val(b.coords.latitude),$("#wcmp_vlist_center_lng").val(b.coords.longitude),a.setCenter(c),a.fitBounds(h)},function(b){e(!0,g,a.getCenter(),b)}):e(!1,g,a.getCenter(),-1),$("#current_location_fetch").on("click",function(b){b.preventDefault(),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(b){var c={lat:b.coords.latitude,lng:b.coords.longitude};$("#wcmp_vlist_center_lat").val(b.coords.latitude),$("#wcmp_vlist_center_lng").val(b.coords.longitude),a.setCenter(c),a.fitBounds(h)},function(b){e(!0,g,a.getCenter(),b)}):e(!1,g,a.getCenter(),-1)}),wcmp_vendor_list_script_data.stores.forEach(function(d){var b,c;b=d,h.extend(new google.maps.LatLng(b.location.lat,b.location.lng)),c=new google.maps.Marker({map:a,icon:wcmp_vendor_list_script_data.map_data.marker_icon,position:new google.maps.LatLng(b.location.lat,b.location.lng),title:b.store_name}),google.maps.event.addListener(c,"click",function(){g.setContent(b.info_html),g.open(a,c)}),i.push(c)}),wcmp_vendor_list_script_data.autocomplete){var f=document.getElementById("locationText"),j=new google.maps.places.Autocomplete(f);j.addListener("place_changed",function(){var b=j.getPlace();if(!b.geometry){window.alert("Autocomplete returned place contains no geometry");return}b.geometry.viewport?a.fitBounds(b.geometry.viewport):(a.setCenter(b.geometry.location),a.setZoom(17)),$("#wcmp_vlist_center_lat").val(b.geometry.location.lat()),$("#wcmp_vlist_center_lng").val(b.geometry.location.lng())})}else $("#locationText").on("input",function(){var b=$(this).val();new google.maps.Geocoder().geocode({address:b},function(c,d){if(d==google.maps.GeocoderStatus.OK){var b=c[0].geometry.location;a.setCenter(b),$("#wcmp_vlist_center_lat").val(b.lat()),$("#wcmp_vlist_center_lng").val(b.lng())}})})})}}(jQuery)